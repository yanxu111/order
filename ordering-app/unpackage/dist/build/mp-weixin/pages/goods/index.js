(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/index"],{3812:function(t,o,e){"use strict";(function(t){e("b225");n(e("66fd"));var o=n(e("7747"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(o.default)}).call(this,e("543d")["createPage"])},"4b57":function(t,o,e){"use strict";var n=e("8013"),s=e.n(n);s.a},"58db":function(t,o,e){"use strict";e.r(o);var n=e("b5e6"),s=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(o,t,(function(){return n[t]}))}(a);o["default"]=s.a},7747:function(t,o,e){"use strict";e.r(o);var n=e("c4ab"),s=e("58db");for(var a in s)"default"!==a&&function(t){e.d(o,t,(function(){return s[t]}))}(a);e("4b57");var i,r=e("f0c5"),c=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,"40d4780e",null,!1,n["a"],i);o["default"]=c.exports},8013:function(t,o,e){},b5e6:function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=e("26cb");function s(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,n)}return e}function a(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?s(Object(e),!0).forEach((function(o){i(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):s(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function i(t,o,e){return o in t?Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[o]=e,t}var r={name:"goods",data:function(){return{goodsAction:!0,businessAction:!1,branchShopId:"",goodsId:"",tableCode:"",goodsAmount:0,isCartShow:!1}},onLoad:function(t){var o=this;this.branchShopId=t.branch_shop_id?t.branch_shop_id:"",this.goodsId=t.gid?t.gid:"",this.tableCode=t.table_code?t.table_code:"",this.getShopInfo({branch_shop_id:this.branchShopId}),this.$token.safeUser(this,this.branchShopId,this.tableCode,(function(){o.getCart({branch_shop_id:o.branchShopId,table_code:o.tableCode,success:function(){o.getShopGoods({branch_shop_id:o.branchShopId,complete:function(t){o.getGoodsItemsInfo({branch_shop_id:o.branchShopId})}})}})})),this.SET_TABLE_CODE({isTableCode:this.tableCode})},methods:a(a(a({changeTag:function(t,o){this.goodsAction=t,this.businessAction=o}},(0,n.mapMutations)({SET_TABLE_CODE:"cart/SET_TABLE_CODE",SET_GOODS_AMOUNT:"goods/SET_GOODS_AMOUNT"})),(0,n.mapActions)({getShopInfo:"goods/getShopInfo",getShopGoods:"goods/getShopGoods",getGoodsItemsInfo:"goods/getGoodsItemsInfo",saveCart:"cart/saveCart",getCart:"cart/getCart",deleteCart:"cart/deleteCart",setCartAmount:"cart/setCartAmount",setAmount:"cart/setAmount"})),{},{goBack:function(o){t.redirectTo({url:o})},showGoodsDetails:function(o){"1"===o.is_meal?t.navigateTo({url:"/pages/goods/meal?branch_shop_id=".concat(this.branchShopId,"&gid=").concat(o.gid,"&table_code=").concat(this.tableCode)}):(this.goodsId=o.gid,this.goodsAmount=o.amount)},incAmount:function(o,e,n){var s=this;t.getStorageSync("isLogin")?this.$token.safeUser(this,this.branchShopId,this.tableCode,(function(){for(var t=!1,a=e&&e.length>0?JSON.stringify(e):"",i=0;i<s.goodsItems.length;i++)for(var r=0;r<s.goodsItems[i].goods.length;r++){var c=s.goodsItems[i].goods[r].new_meal_items&&s.goodsItems[i].goods[r].new_meal_items.length>0?JSON.stringify(s.goodsItems[i].goods[r].new_meal_items):"";if(s.goodsItems[i].goods[r].gid===o&&c===a){t=!0,s.goodsAmount=parseInt(s.goodsItems[i].goods[r].amount)+1;var d={title:s.goodsItems[i].goods[r].title,price:s.goodsItems[i].goods[r].price,amount:1,pack_price:s.goodsItems[i].goods[r].pack_price?s.goodsItems[i].goods[r].pack_price:"",branch_shop_id:s.branchShopId,table_code:s.tableCode,meal_items:s.goodsItems[i].goods[r].meal_items,gid:o,place_type:"0",is_meal:s.goodsItems[i].goods[r].is_meal,meal_type:"0",new_meal_items:s.goodsItems[i].goods[r].new_meal_items,amountInput:!1,amountInputFocus:!1};s.saveCart({cartData:d})}}if(!t){var h={amount:1,branch_shop_id:s.branchShopId,table_code:s.tableCode,meal_items:n,gid:o,is_meal:1,meal_type:1,new_meal_items:e,amountInput:!1,amountInputFocus:!1};s.saveCart({cartData:h})}})):t.showToast({title:"请先登录后操作",icon:"none",duration:2e3,success:function(){setTimeout((function(){t.navigateTo({url:"/pages/login/index?branch_shop_id=".concat(s.branchShopId,"&table_code=").concat(s.tableCode)})}),2e3)}})},setCartGoodsAmount:function(t,o,e){for(var n=o&&o.length>0?JSON.stringify(o):"",s=!1,a=0;a<this.goodsItems.length;a++)for(var i=0;i<this.goodsItems[a].goods.length;i++){var r=this.goodsItems[a].goods[i].new_meal_items&&this.goodsItems[a].goods[i].new_meal_items.length>0?JSON.stringify(this.goodsItems[a].goods[i].new_meal_items):"";t===this.goodsItems[a].goods[i].gid&&n===r&&(s=!0,this.goodsItems[a].goods[i].amount=parseInt(this.goodsItems[a].goods[i].amount)-1,this.goodsAmount=this.goodsItems[a].goods[i].amount,this.setCartAmount({cartData:this.goodsItems[a].goods[i],branch_shop_id:this.branchShopId}))}s||this.setCartAmount({cartData:{gid:t,new_meal_items:o,meal_type:"1"},branch_shop_id:this.branchShopId})},setAmountInput:function(t,o,e,n){var s=t.target.value;this.SET_GOODS_AMOUNT({gid:o,new_meal_items:e,amount:s}),this.setAmount({cartData:{gid:o,new_meal_items:e,amount:s},branch_shop_id:this.branchShopId})},CartShow:function(){var t=this;this.$token.safeUser(this,this.branchShopId,this.tableCode,(function(){t.getCart({branch_shop_id:t.branchShopId,table_code:t.tableCode,success:function(){t.isCartShow=!0}})}))},delCartInfo:function(){this.deleteCart({branch_shop_id:this.branchShopId,table_code:this.tableCode,success:function(){t.showToast({title:"清空购物车成功",icon:"success",success:function(){}})}})},submitPayInfo:function(){this.amountCount>0?t.navigateTo({url:"/user_pages/order/index?branch_shop_id=".concat(this.branchShopId,"&table_code=").concat(this.tableCode)}):t.showToast({title:"请先添加菜品",icon:"none"})},goPageMyOrder:function(){var o=this;this.$token.safeUser(this,this.branchShopId,this.tableCode,(function(){t.navigateTo({url:"/pages/myorder/index?branch_shop_id=".concat(o.branchShopId,"&table_code=").concat(o.tableCode)})}))},pushAge:function(o){console.log(o),t.navigateTo({url:o})},focusWeixin:function(){t.navigateTo({url:"/pages/main/focus"})},onShareAppMessage:function(){return{title:this.shopInfo.branch_shop_name,path:"/pages/goods/index?branch_shop_id="+this.branchShopId+"&table_code="+this.tableCode,imageUrl:this.shopInfo.logo}}}),computed:a(a(a({},(0,n.mapState)({shopInfo:function(t){return t.goods.shopInfo},shopGoods:function(t){return t.goods.shopGoods},goodsItems:function(t){return t.goods.goodsItems},cartData:function(t){return t.cart.cartData},amountCount:function(t){return t.cart.cartAmount}})),(0,n.mapGetters)({isTotal:"cart/total"})),{},{cartShowStatus:function(){return this.cartData.length>0||(this.isCartShow=!1),this.isCartShow}})};o.default=r}).call(this,e("543d")["default"])},c4ab:function(t,o,e){"use strict";e.d(o,"b",(function(){return s})),e.d(o,"c",(function(){return a})),e.d(o,"a",(function(){return n}));var n={goods:function(){return e.e("components/goods/goods").then(e.bind(null,"77fb"))},business:function(){return e.e("components/business/business").then(e.bind(null,"c670"))},cart:function(){return e.e("components/cart/cart").then(e.bind(null,"2b5e"))}},s=function(){var t=this,o=t.$createElement;t._self._c;t._isMounted||(t.e0=function(o){t.isCartShow=!1})},a=[]}},[["3812","common/runtime","common/vendor"]]]);